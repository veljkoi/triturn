var Demo={level:0,moves:{a:[],b:[]},rawMoves:{a:[],b:[]},cursor:{a:-1,b:-1},cursorLimit:{a:0,b:0},blockClick:0,played:!1,pointer:null,timeout:400,firstMessage:"Click on right-arrow and left-arrow buttons to go through the demo. On the table, you can watch a sample game and explanations are shown here.",messages:[],noteClass:[],resetParams:function(){this.level=0;this.moves={a:[],b:[]};this.rawMoves={a:[],b:[]};this.cursor={a:-1,b:-1};this.cursorLimit={a:0,b:0};this.blockClick=0;this.played=!1;this.timeout=
400;Util.showSelectButton();this.messages="<strong>Selection</strong>: Pick 5 triangles from the white section on the left. If you click on a triangle inside this section it turns red and is picked. If you click on it again it turns white and is not picked. Click on SELECT button to select them. You have 60 seconds for this.;<strong>Goal</strong>: The goal of the game is to move all 5 triangles to the white section on the right. You must avoid black obstacles.;<strong>Moving</strong>: When you click on a red triangle it turns brighter and is selected for moving. If you click on it again it returns to its basic color and can't be moved.;You can move 1, 2, 3, 4 or 5 triangles at once. If you want to move only one triangle, click on it - it is selected for moving now. It is moved by turning it over one of its edges. Triangles to where it is allowed to be moved become yellow and suggest you all the possibilities. If you click on a yellow suggestion your selected triangle is moved.;If you want to move: 2, 3, 4 or 5 triangles at once, they need to be connected by their edges, i.e. they form a geometric shape. That geometric shape is moved by turning it over one of its edges. Yellow suggestions show you all the possibilities. You decide where you want to move it to and click on a suggestion. All 2, 3, 4 or 5 selected triangles are moved now using only 1 move.;This is the purpose of the game, to use as smallest number of moves as possible to move triangles to the white section on the right.<br>You have 30 seconds to make a move.;<strong>Computer</strong>: When you start a game, you play versus computer which starts from the right section of the table and goes in the opposite direction, to the left white section. Computer's triangles are blue.;<strong>Points</strong>: By playing games of higher level and by making less moves, you can score more points.;<strong>Registered</strong>: For registered players (only username and password required), their played games are remembered and last 20 played games are shown in the History table. From the table History, a player can replay a played game to see all her/his moves as well as computer moves. Also, their rating is shown in the Standings table. The rating is calculated by averaging points of last 20 played games.".split(";");
this.noteClass="left;right;;;;;right blue;;".split(";")},startPlayed:function(a){Util.hideMessage("table");this.resetParams();this.played=!0;this.timeout=300;Util.hideSelectButton();a=Played.get(a);this.level=a.level;this.moves.a=a.a_moves;this.moves.b=a.b_moves;this.rawMoves.a=a.a_raw_moves;this.rawMoves.b=a.b_raw_moves;this.cursorLimit.a=a.a_moves.length;this.cursorLimit.b=a.b_moves.length;this.blockClick=0;$(".demo-box").find(".info").html(a.start_time+"&nbsp;&nbsp;&nbsp; level "+a.level+"&nbsp;&nbsp;&nbsp; points "+
a.points+"/"+a.max_points);Game.startDemo(a.obstacles);this.showB();Util.scroll("table")},startDemo:function(){this.resetParams();var a=this.getDemo();this.level=a.level;$(".demo-box").find(".info").text("Demo - level "+a.level);this.moves.a=a.moves;this.rawMoves.a=a.raw_moves;this.cursorLimit.a=a.moves.length;this.blockClick=0;Game.startDemo(a.obstacles);this.pointer.show();this.hideB();a=3*this.level;this.messages[this.cursorLimit.a-1]="GAME OVER - SCORE: "+a+"/"+a;this.noteClass[this.cursorLimit.a-
1]="right";Util.hideDirsBox();Util.showDemoNotes();this.showFirstMessage()},hideB:function(){$(".demo-box").find(".b-box").hide()},showB:function(){$(".demo-box").find(".b-box").show()},getDemo:function(){var a;$.ajax({url:"index.php",async:!1,type:"POST",dataType:"json",data:{action:"get_demo"},success:function(b){b&&(a=b)}});return a},move:function(a,b){if(this.blockClick)return!1;this.blockClick=1;this.showMessage(b);if(b)if(this.cursor[a]++,this.cursor[a]<this.cursorLimit[a]){"a"==a?Game.setActive():
Game.setInactive();var c=this.moves[a][this.cursor[a]];if(0<c.length){this.blockClick=c.length;"a"==a&&0==Game.selected.a&&this.blockClick++;for(var d=0;d<c.length;d++){var e=document.getElementById(""+c[d]);setTimeout(Demo.triggerClick,Demo.timeout*(d+1),[e])}"a"==a&&0==Game.selected.a&&(setTimeout(Demo.triggerSelectClick,Demo.timeout*(d+1)),0<this.cursor[a]&&(Game.movesHtml[Game.active].innerHTML=++Game.moves[Game.active]))}else 0<this.cursor[a]&&(Game.movesHtml[Game.active].innerHTML=++Game.moves[Game.active]),
this.blockClick=0}else this.cursor[a]--,this.blockClick=0;else{this.cursor[a]--;if(-2<this.cursor[a]){"a"==a?Game.setActive():Game.setInactive();for(d=0;d<Game.players[Game.active].length;d++)-1<Game.players[Game.nonActive].indexOf(parseInt(Game.players[Game.active][d]))?Util.setFieldColor(Game.players[Game.active][d],Game.colors[Game.nonActive]):3E3>Game.players[Game.active][d]||10900<Game.players[Game.active][d]?Util.setFieldColor(Game.players[Game.active][d],Util.colorOut):Util.setFieldColor(Game.players[Game.active][d],
Util.colorTable);Game.players[a]=[];if(-1<this.cursor[a]){c=this.rawMoves[a][this.cursor[a]];if(1>c.length)this.played||Util.showSelectButton(),Game.selected[Game.active]=!1;else for(d=0;d<c.length;d++)3E3>c[d]&&"b"==a||10900<c[d]&&"a"==a||(-1<Game.players[Game.nonActive].indexOf(parseInt(c[d]))?Util.setFieldColor(c[d],Util.colorMixed):Util.setFieldColor(c[d],Game.colors[Game.active]),Game.players[a].push(parseInt(c[d])));0<Game.moves[Game.active]&&Game.moves[Game.active]--}else"a"!=a||this.played||
(Util.showSelectButton(),this.showFirstMessage()),Game.selected[Game.active]=!1;Game.movesHtml[Game.active].innerHTML=Game.moves[Game.active]}else this.cursor[a]++;this.blockClick=0}},triggerClick:function(a){if(Demo.played)$(a).trigger("demoClick"),Demo.blockClick--;else{var b=$(a).offset(),c=$(a).attr("id");"1"==c.charAt(c.length-2)?(b.top+=15,b.left+=30):(b.top+=30,b.left+=15);Demo.pointer.offset({top:b.top,left:b.left});setTimeout(function(){$(a).trigger("demoClick");Demo.blockClick--},200)}},
triggerSelectClick:function(){var a=$(".demo-box").find(".select-button");if(!Demo.played){var b=a.offset();b.top+=15;b.left+=54;Demo.pointer.offset({top:b.top,left:b.left})}a.css({color:"#333","border-color":"#888",outline:"0"});setTimeout(function(){a.css({color:"#555","border-color":"#BBB",outline:"initial"});Game.fieldsSelected("a");Game.selected.a=!0;Demo.blockClick=0},500)},showMessage:function(a){this.played||(a&&this.messages[this.cursor.a+1]?$(".demo-note").removeClass("left right blue").addClass(this.noteClass[this.cursor.a+
1]).html(this.messages[this.cursor.a+1]).show():-1<this.cursor.a&&this.cursor.a<this.cursorLimit.a-1&&$(".demo-note").hide())},showFirstMessage:function(){$(".demo-note").removeClass("left right blue").html(this.firstMessage).show()}},Game={FIRST_MOVE_TIME:60,MOVE_TIME:30,players:{a:[],b:[]},passed:{a:[],b:[]},active:"a",nonActive:"b",colors:{a:"#880000",b:"#000088"},activeColors:{a:"#FF0000",b:"#0000FF"},selectedFields:[],obstacles:[],selected:{a:!1,b:!1},moves:{a:0,b:0},movesHtml:{a:null,b:null},
timer:null,timerHtml:null,timerId:null,suggestFields:[],suggestGroups:[],ambiguous:[],demo:!1,level:0,points:0,maxPoints:0,pointsHtml:null,play:function(){Util.hideMessage("table");var a=$("#level").val();if(!a)return!1;var b=this;$.ajax({url:"index.php",type:"POST",dataType:"json",data:{action:"get_game",level:a,timezoneOffset:(new Date).getTimezoneOffset()},success:function(c){c&&(c.obstacles&&0<c.obstacles.length&&(b.obstacles=c.obstacles,b.minMoves=c.min_moves,b.step=c.step,b.level=a,b.maxPoints=
3*a,b.points=3*a,b.startGame()),c.message?Util.showMessage("table",c.message):Util.hideMessage("table"))}})},quit:function(a){this.unbindEvents("click systemClick");this.stopTimer();$.ajax({url:"index.php",type:"POST",dataType:"json",data:{action:"quit"},success:function(b){b&&(b.error||(Game.highlightPoints(b.points),Util.hideQuitButton(),Util.showPlayDemoLink()),b.saved&&(Standings.refresh(),Played.refresh()),a?(Util.showDir("end",a),Game.blinkBold($(".dir.end"),2)):b.message&&(Util.showDir("end",
b.message),Game.blinkBold($(".dir.end"),2)))}})},startGame:function(){Util.clearTable();this.resetVars();this.resetHtmlMoves();this.setPoints();this.setObstacles();Util.showSelectButton();Util.showQuitButton();Util.showBox(!1,"game");Util.hidePlayDemoLink();this.bindEvents("click systemClick");this.startTimer(this.FIRST_MOVE_TIME)},resetVars:function(){this.players={a:[],b:[]};this.passed={a:[],b:[]};this.active="a";this.nonActive="b";this.selectedFields=[];this.selected={a:!1,b:!1};this.moves={a:0,
b:0};this.timerHtml=document.getElementById("timer");this.pointsHtml=document.getElementById("points");this.pointsHtml.style["border-bottom"]="none";this.suggestFields=[];this.suggestGroups=[];this.ambiguous=[];this.demo=!1;this.maxPoints=this.points=0;Util.blinkBoldId=null;Util.blinkBoldElement=null;Demo.pointer.hide()},resetHtmlMoves:function(){this.demo?(this.movesHtml.a=document.getElementById("demo-counter-a"),this.movesHtml.b=document.getElementById("demo-counter-b")):(this.movesHtml.a=document.getElementById("counter-a"),
this.movesHtml.b=document.getElementById("counter-b"));this.movesHtml.a.innerHTML=0;this.movesHtml.b.innerHTML=0},setPoints:function(){$(this.pointsHtml).text(3*this.level);$(".game-box").find(".max-points").text(3*this.level);$(".game-box").find(".info").text("Game - level "+this.level)},setObstacles:function(){Util.setGroupColor(this.obstacles,Util.colorObstacle)},bindEvents:function(a){$(".field").on(a,this.fieldClickHandler)},unbindEvents:function(a){$(".field").off(a,this.fieldClickHandler)},
fieldsSelected:function(a){if(this.active!=a)return!1;5==this.selectedFields.length?("a"==a&&Util.hideSelectButton(),this.selectedFields.sort(Util.sortNumber),this.players[this.active]=this.selectedFields,this.selectedFields=[],this.selected[this.active]=!0,this.demo||("b"==a?this.startTimer(this.MOVE_TIME):(Util.stopBlinkBold(),this.stopTimer(),this.selected.b&&(this.movesHtml.a.innerHTML=++this.moves.a,this.updatePoints()),this.systemMove(1))),this.suggest()):Util.blinkBold($(".dir.start").find(".blink"),
3)},startTimer:function(a){this.setActive();this.timer=a;this.timerHtml.innerHTML=this.timer;this.timerId=setInterval(this.tick,1E3);this.selected.a?(Util.showDir("move"),Util.blinkBold($(".dir.move"),3)):Util.showDir("start")},stopTimer:function(){this.setInactive();clearInterval(this.timerId);5>Game.passed.b.length?Util.showDir("comp"):Util.hideDirs()},setActive:function(){this.active="a";this.nonActive="b";this.demo||(this.movesHtml.b.style["border-bottom"]="none",this.movesHtml.a.style["border-bottom"]=
"3px solid "+this.colors.a)},setInactive:function(){this.active="b";this.nonActive="a";this.demo||(this.movesHtml.a.style["border-bottom"]="none",this.movesHtml.b.style["border-bottom"]="3px solid "+this.colors.b)},tick:function(){Game.timerHtml.innerHTML=--Game.timer;if(1>Game.timer){Game.blinkId&&(clearTimeout(Game.blinkId),Game.blinkId=null);Util.stopBlinkBold();for(var a=0;a<Game.selectedFields.length;a++)Game.selected[Game.active]?-1<Game.players[Game.nonActive].indexOf(Game.selectedFields[a])?
Util.setFieldColor(Game.selectedFields[a],Util.colorMixed):Util.setFieldColor(Game.selectedFields[a],Game.colors[Game.active]):Util.setFieldColor(Game.selectedFields[a],Util.colorOut);if(Game.selected[Game.active]||Game.selected[Game.nonActive])Game.movesHtml[Game.active].innerHTML=++Game.moves[Game.active],Game.updatePoints();Game.stopTimer();Game.selectedFields=[];Game.suggest();Game.moves[Game.active]<Game.minMoves?Game.systemMove(0):5>Game.passed[Game.nonActive].length&&(Game.systemMove(0),Game.startTimer(Game.MOVE_TIME))}},
systemMove:function(a){a=[].concat(this.players.a,this.passed.a);var b=2,c=this;$.ajax({url:"index.php",type:"POST",dataType:"json",data:{action:"move",player:a},success:function(a){if(a)if(a.valid){if(a.move)for(var e=0;e<a.move.length;e++){var f=document.getElementById(""+a.move[e]);setTimeout(c.triggerClick,600*(e+1),[f])}}else a.message?c.quit(a.message):c.quit();else 0<b?(b--,c.systemMove()):c.quit("An error occurred while making new move! Sorry, the game is over.")},error:function(){0<b?(b--,
c.systemMove()):c.quit("An error occurred while making new move! Sorry, the game is over.")}})},setTime:function(){$.post("index.php?action=set_time")},triggerClick:function(a){$(a).trigger("systemClick")},restoreGroupColors:function(a){for(var b=0;b<a.length;b++){var c;c=-1<this.players[this.active].indexOf(a[b])&&-1<this.players[this.nonActive].indexOf(a[b])?Util.colorMixed:-1<this.players[this.active].indexOf(a[b])?this.colors[this.active]:-1<this.players[this.nonActive].indexOf(a[b])?this.colors[this.nonActive]:
3E3>a[b]||10900<a[b]?Util.colorOut:Util.colorTable;Util.setFieldColor(a[b],c)}},suggest:function(){var a=this.selectedFields.length;if(0==a)0<this.suggestFields.length&&(this.restoreGroupColors(this.suggestFields),this.suggestFields=[],this.suggestGroups=[],this.ambiguous=[]);else{this.selectedFields.sort(Util.sortNumber);var b=[];switch(a){case 1:void 0!==map1[this.selectedFields[0]]&&(b=map1[this.selectedFields[0]]);break;case 2:void 0!==map2[this.selectedFields[0]]&&void 0!==map2[this.selectedFields[0]][this.selectedFields[1]]&&
(b=map2[this.selectedFields[0]][this.selectedFields[1]]);break;case 3:void 0!==map3[this.selectedFields[0]]&&void 0!==map3[this.selectedFields[0]][this.selectedFields[1]]&&void 0!==map3[this.selectedFields[0]][this.selectedFields[1]][this.selectedFields[2]]&&(b=map3[this.selectedFields[0]][this.selectedFields[1]][this.selectedFields[2]]);break;case 4:void 0!==map4[this.selectedFields[0]]&&void 0!==map4[this.selectedFields[0]][this.selectedFields[1]]&&void 0!==map4[this.selectedFields[0]][this.selectedFields[1]][this.selectedFields[2]]&&
void 0!==map4[this.selectedFields[0]][this.selectedFields[1]][this.selectedFields[2]][this.selectedFields[3]]&&(b=map4[this.selectedFields[0]][this.selectedFields[1]][this.selectedFields[2]][this.selectedFields[3]]);break;case 5:void 0!==map5[this.selectedFields[0]]&&void 0!==map5[this.selectedFields[0]][this.selectedFields[1]]&&void 0!==map5[this.selectedFields[0]][this.selectedFields[1]][this.selectedFields[2]]&&void 0!==map5[this.selectedFields[0]][this.selectedFields[1]][this.selectedFields[2]][this.selectedFields[3]]&&
void 0!==map5[this.selectedFields[0]][this.selectedFields[1]][this.selectedFields[2]][this.selectedFields[3]][this.selectedFields[4]]&&(b=map5[this.selectedFields[0]][this.selectedFields[1]][this.selectedFields[2]][this.selectedFields[3]][this.selectedFields[4]])}var a=[],c=[],d=[];if(void 0!==b&&0<b.length)for(var e=0;e<b.length;e++){for(var f=[],g=0;g<b[e].length;g++){if(-1<this.selectedFields.indexOf(b[e][g])||-1<this.obstacles.indexOf(b[e][g])||-1<this.players[this.active].indexOf(b[e][g])){f=
[];break}f.push(b[e][g])}if(0<f.length)for(c.push(f),g=0;g<f.length;g++)-1===a.indexOf(f[g])?a.push(f[g]):d.push(f[g])}0<this.suggestFields.length&&this.restoreGroupColors(this.suggestFields);0<a.length&&Util.setGroupColor(a,Util.colorSuggest);this.suggestFields=a;this.ambiguous=d;this.suggestGroups=c}},blinkId:null,blink:function(a){Util.setGroupColor(a[0],Util.colorBlink);Game.blinkId=setTimeout(function(){Util.setGroupColor(a[0],Util.colorSuggest);Util.setGroupColor(a[1],Util.colorBlink);Game.blinkId=
setTimeout(function(){Util.setGroupColor(a[1],Util.colorSuggest)},300)},300)},fieldClickHandler:function(a){var b=parseInt(a.target.id),c="systemClick"===a.type;if("b"==Game.active&&!c&&"demoClick"!==a.type)return!1;if(!Game.selected[Game.active]){if(3E3>b&&"a"==Game.active||10900<b&&"b"==Game.active)-1<Game.selectedFields.indexOf(b)?(Game.selectedFields.splice(Game.selectedFields.indexOf(b),1),Util.setFieldColor(b,Util.colorOut)):(5>Game.selectedFields.length&&(Game.selectedFields.push(b),Util.setFieldColor(b,
Game.colors[Game.active])),"b"==Game.active&&5==Game.selectedFields.length&&Game.fieldsSelected("b"));return!1}if(-1<Game.players[Game.active].indexOf(b))-1<Game.selectedFields.indexOf(b)?(Game.selectedFields.splice(Game.selectedFields.indexOf(b),1),-1<Game.players[Game.nonActive].indexOf(b)?Util.setFieldColor(b,Util.colorMixed):Util.setFieldColor(b,Game.colors[Game.active])):(Game.selectedFields.push(b),Util.setFieldColor(b,Game.activeColors[Game.active])),Game.suggest();else if(Game.selectedFields.length&&
-1<Game.suggestFields.indexOf(b)){if(-1<Game.ambiguous.indexOf(b)){c=[];for(a=0;a<Game.suggestGroups.length;a++)-1<Game.suggestGroups[a].indexOf(b)&&c.push(Game.suggestGroups[a]);Game.blink(c);return!1}var d=!1;for(a=0;a<Game.suggestGroups.length;a++)-1<Game.suggestGroups[a].indexOf(b)&&(d=Game.suggestGroups[a]);if(d){Game.blinkId&&(clearTimeout(Game.blinkId),Game.blinkId=null);Util.stopBlinkBold();for(a=0;a<Game.selectedFields.length;a++)b=Game.players[Game.active].indexOf(parseInt(Game.selectedFields[a])),
-1<b&&(Game.players[Game.active].splice(b,1),-1<Game.players[Game.nonActive].indexOf(parseInt(Game.selectedFields[a]))?Util.setFieldColor(Game.selectedFields[a],Game.colors[Game.nonActive]):3E3>Game.selectedFields[a]||10900<Game.selectedFields[a]?Util.setFieldColor(Game.selectedFields[a],Util.colorOut):Util.setFieldColor(Game.selectedFields[a],Util.colorTable));var e=[],f=Game.nonActive;for(a=0;a<d.length;a++)3E3>d[a]&&"b"===Game.active||10900<d[a]&&"a"===Game.active?(e.push(d[a]),Game.players[Game.nonActive].indexOf(parseInt(d[a]))?
Util.setFieldColor(d[a],Util.colorMixed):Util.setFieldColor(d[a],Game.colors[Game.active])):-1<Game.players[Game.nonActive].indexOf(parseInt(d[a]))?(Game.players[Game.active].push(d[a]),Util.setFieldColor(d[a],Util.colorMixed)):(Game.players[Game.active].push(d[a]),Util.setFieldColor(d[a],Game.colors[Game.active]));Game.passed[Game.active]=Game.passed[Game.active].concat(e);Game.movesHtml[Game.active].innerHTML=++Game.moves[Game.active];Game.demo||(c?5>Game.passed.a.length?(Game.setTime(),Game.startTimer(Game.MOVE_TIME)):
Game.saveGame(0):(Game.stopTimer(),Game.updatePoints(),5>Game.passed.b.length?Game.systemMove(0):5>Game.passed.a.length?(Game.systemMove(0),Game.startTimer(Game.MOVE_TIME)):Game.saveGame(1)));0<e.length&&setTimeout(function(){for(var a=0;a<e.length;a++)-1<Game.players[f].indexOf(parseInt(e[a]))?Util.setFieldColor(e[a],Game.colors[f]):Util.setFieldColor(e[a],Util.colorOut)},500)}Game.selectedFields=[];Game.suggest()}},saveGame:function(a){this.unbindEvents("click systemClick");var b=[].concat(this.players.a,
this.passed.a),c=this;$.ajax({url:"index.php",type:"POST",dataType:"json",data:{action:"save_game",validate:a,player:b},success:function(a){a&&(a.valid?(a.error||(c.highlightPoints(a.points),Util.hideQuitButton(),Util.showPlayDemoLink()),a.saved&&(Standings.refresh(),Played.refresh()),a.message&&(Util.showDir("end",a.message),Util.blinkBold($(".dir.end"),3))):a.message?c.quit(a.message):c.quit())}})},startDemo:function(a){Util.clearTable();this.resetVars();this.demo=!0;this.resetHtmlMoves();this.obstacles=
a;this.setObstacles();Util.showBox(!1,"demo");this.unbindEvents("demoClick");this.bindEvents("demoClick")},updatePoints:function(){if(this.moves.a>this.minMoves){var a=8<this.level?Math.round(3*this.level-(this.moves.a-this.minMoves)*(this.level/2-2.5)):Math.round(3*this.level-(this.moves.a-this.minMoves)*this.step);0>a&&(a=0);$(this.pointsHtml).text(a)}},highlightPoints:function(a){$(this.pointsHtml).text(a);this.pointsHtml.style.color=this.colors.a;this.pointsHtml.style["border-bottom"]="3px solid "+
this.colors.a}},Played={refresh:function(){this.clear();this.getList()},getList:function(){$.ajax({url:"index.php?action=get_played_list",type:"GET",success:function(a){a&&$("#history").find("div").append($(a))}})},clear:function(){$("#history").find("div").html("")},get:function(a){var b;$.ajax({url:"index.php",async:!1,type:"POST",dataType:"json",data:{action:"get_played",id:a},success:function(a){a&&(b=a)}});return b}},Player={validate:function(a){var b=$(a).find("[name='action']").val(),c=$(a).find("[name='username']"),
d=$(a).find("[name='password']"),e=$(a).find("[name='repeat_password']"),f="",g=!1;""==c.val().trim()?(f+=" Username is required! ",g=c):255<c.val().trim().length&&(f+=" Username can have max 255 characters! ",g=c);""==d.val().trim()?"profile"!=b&&(f+=" Password is required! ",g||(g=d)):0<e.length&&d.val()!=e.val()&&(f+=" Passwords do not match! ",g||(g=e));"password_forgotten"==b&&(a=$(a).find("[name='email']"),""==a.val().trim()&&(f+=" Email is required! ",g||(g=a)));return f?(Util.showMessage(b,
f),g&&g.focus(),!1):!0},statusChangeCallback:function(a){"connected"===a.status&&FB.api("/me",function(a){console.log(a);$.ajax({url:"index.php?action=fb_login",type:"POST",dataType:"json",data:a,success:function(a){a?a.session_id?(document.cookie="PHPSESSID="+a.session_id,location.reload()):a.message&&Util.showMessage(a.message):Util.showMessage("An error occurred while logging! Please try again.")},error:function(){Util.showMessage("An error occurred while logging! Please try again.")}})})},checkLoginState:function(){FB.getLoginStatus(function(a){Player.statusChangeCallback(a)})},
fbLogout:function(a,b){a.preventDefault();FB.getLoginStatus(function(a){"connected"===a.status&&FB.logout(function(a){a.status&&"connected"!==a.status&&$(b).closest("form").submit()})})}},Standings={refresh:function(){this.clear();this.get()},get:function(){$.ajax({url:"index.php?action=get_standings",type:"GET",success:function(a){a&&$("#standings").find("div").append($(a))}})},clear:function(){$("#standings").find("div").html("")}},Util={colorTable:"#EEEEEE",colorOut:"#FFFFFF",colorObstacle:"#222222",
colorMixed:"#880088",colorSuggest:"#FFFF99",colorBlink:"#FFCC00",blinkBoldId:null,blinkBoldElement:null,showBox:function(a,b){a&&(a.preventDefault(),a.stopImmediatePropagation());this.hideMessage("table");Util.showDirsBox();Util.hideDirs();Util.hideDemoNotes();$(".slide-box").not("."+b+"-box").hide();$("."+b+"-box").show()},sortNumber:function(a,b){return a-b},showMessage:function(a,b){$(".message").filter("."+a).html(b).show()},hideMessage:function(a){$(".message").filter("."+a).html("").hide()},
clearTable:function(){for(var a,b=1;13>b;b++)for(var c=1;6>c;c++)a=3>b||10<b?this.colorOut:this.colorTable,this.setFieldColor(""+b+c+"00",a),this.setFieldColor(""+b+c+"01",a),this.setFieldColor(""+b+c+"10",a),this.setFieldColor(""+b+c+"11",a)},showSelectButton:function(){$(".select-button").css("visibility","visible")},hideSelectButton:function(){$(".select-button").css("visibility","hidden")},showQuitButton:function(){$(".quit-button").css("display","inline-block")},hideQuitButton:function(){$(".quit-button").hide()},
setFieldColor:function(a,b){document.getElementById(""+a).style.fill=b},setGroupColor:function(a,b){for(var c=0;c<a.length;c++)this.setFieldColor(a[c],b)},showPlayDemoLink:function(){$(".play-demo").show()},hidePlayDemoLink:function(){$(".play-demo").hide()},scroll:function(a,b){b||Util.hideMessage("table");$(document).off("scroll");$("html, body").stop().animate({scrollTop:$("#"+a).offset().top-40},0,"swing",function(){$(document).on("scroll",Util.onScroll)})},nav:null,body:null,window:null,navOffsetTop:0,
initScroll:function(){this.nav=$(".navbar");this.body=$("body");this.window=$(window);this.navOffsetTop=this.nav.offset().top;this.window.on("scroll",this.onScroll);this.window.on("resize",this.resize);$("a.anchor").on("click",this.smoothScroll)},smoothScroll:function(a){a.preventDefault();Util.hideMessage("table");$(document).off("scroll");$("html, body").stop().animate({scrollTop:$(this.hash).offset().top-40},0,"swing",function(){$(document).on("scroll",Util.onScroll)})},resize:function(){Util.body.removeClass("has-docked-nav");
Util.navOffsetTop=Util.nav.offset().top;Util.onScroll()},onScroll:function(){Util.navOffsetTop<Util.window.scrollTop()&&!Util.body.hasClass("has-docked-nav")&&Util.body.addClass("has-docked-nav");Util.navOffsetTop>Util.window.scrollTop()&&Util.body.hasClass("has-docked-nav")&&Util.body.removeClass("has-docked-nav")},showSection:function(a){a.preventDefault();a=$(a.target);$(a.attr("href")).removeClass("hidden");a.addClass("hidden")},showDir:function(a,b){Util.hideDirs();void 0===b?$(".dirs").find(".dir."+
a).show():$(".dirs").find(".dir."+a).html(b).show()},hideDirs:function(){$(".dirs").find(".dir").hide()},showDirsBox:function(){$(".dirs").show()},hideDirsBox:function(){$(".dirs").hide()},showDemoNotes:function(){$(".demo-notes").show()},hideDemoNotes:function(){$(".demo-notes").hide()},blinkBold:function(a,b){Util.blinkBoldElement=a;Util.blinkBoldElement.css("font-weight","bold");var c="normal",d=0;b=2*(b-1);Util.blinkBoldId=setInterval(function(){Util.blinkBoldElement.css("font-weight",c);c="bold"==
c?"normal":"bold";d>b&&Util.stopBlinkBold();d++},600)},stopBlinkBold:function(){Util.blinkBoldId&&(clearInterval(Util.blinkBoldId),Util.blinkBoldElement.css("font-weight","normal"),Util.blinkBoldElement=null,Util.blinkBoldId=null)}};